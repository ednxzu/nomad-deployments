---
version: 3
projects:
  - name: authentik
    branch: /main/
    dir: ./authentik/
    workspace: default
    autoplan:
      when_modified: ["*"]
      enabled: true

workflows:
  opentofu:
    plan:
      steps:
        - run: rm -rf .terraform
        - run: tofu init -reconfigure
        - run: tofu plan
    apply:
      steps:
        - run: rm -rf .terraform
        - run: tofu init
        - run: tofu apply -auto-approve
